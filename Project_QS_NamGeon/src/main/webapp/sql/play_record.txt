-- 참여 기록 --
DROP TABLE PLAY_RECORD CASCADE CONSTRAINTS;
CREATE TABLE PLAY_RECORD(
  RECORD_KEY NUMBER,
  CONTENT_KEY NUMBER REFERENCES CONTENT_LIST(CONTENT_KEY) ON DELETE CASCADE,
  MEMBER_KEY NUMBER REFERENCES MEMBER_INFO(MEMBER_KEY) ON DELETE CASCADE,
  SCORE NUMBER DEFAULT 0,
  PLAY_DAY DATE DEFAULT SYSDATE
   , CONSTRAINT PLAY_RECORD_PK PRIMARY KEY (RECORD_KEY, CONTENT_KEY)
);

INSERT INTO PLAY_RECORD (RECORD_KEY,CONTENT_KEY,MEMBER_KEY,SCORE)
VALUES((SELECT NVL(MAX(RECORD_KEY),0)+1 FROM PLAY_RECORD WHERE CONTENT_KEY=1),
      1,1,1);
      
INSERT INTO PLAY_RECORD (RECORD_KEY,CONTENT_KEY,MEMBER_KEY,SCORE)
VALUES((SELECT NVL(MAX(RECORD_KEY),0)+1 FROM PLAY_RECORD WHERE CONTENT_KEY=1),
      1,1,2);

SELECT COUNT(*)
FROM PLAY_RECORD
WHERE CONTENT_KEY = 1;

SELECT * 
FROM PLAY_RECORD;

SELECT ROWNUM RANK,MEMBER_KEY,USER_NAME,SCORE,PLAY_DAY  
FROM (SELECT T10.MEMBER_KEY,USER_NAME,SCORE,PLAY_DAY  
      FROM (SELECT MEMBER_KEY,SCORE,PLAY_DAY 
            FROM PLAY_RECORD
            WHERE CONTENT_KEY = 1) T10
           ,(SELECT MEMBER_KEY,USER_NAME 
            FROM MEMBER_INFO
            WHERE MEMBER_KEY>0) T20
      WHERE T10.MEMBER_KEY = T20.MEMBER_KEY
      ORDER BY SCORE DESC , PLAY_DAY ASC);



            




